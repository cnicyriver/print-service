(function(){var a,i,v,f,e,o,y,t,s,h,c,n,l,r,u;if(i=require("cluster"),s=require("orm"),y=require("moment"),t=require("./lib/nconf"),n=require("restify"),v=require("request-as-curl"),a=require("async"),h=require("./lib/paging"),i.isMaster){require("./lib/printTask")();i.on("exit",function(){return i.fork()});for(o=r=1,u=require("os").cpus().length;1<=u?r<=u:r>=u;o=1<=u?++r:--r)i.fork();return}l=t.get("mysql:user");c=t.get("mysql:password");e=t.get("mysql:host");f=t.get("mysql:dbname");s.connect("mysql://"+l+":"+c+"@"+e+"/"+f,function(i,r){var u,f;if(i){console.log("Cannot connect to Mysql.");throw i;}r.settings.set("connection.debug",!0);f={};u=n.createServer(f);u.use(n.gzipResponse());u.use(n.authorizationParser());u.use(n.bodyParser({mapParams:!1}));u.use(n.queryParser());u.use(function(n,t,i){return n.db=r,n.models=r.models,i()});u.use(n.CORS());u.use(n.fullResponse());u.use(h.supportPagination);u.on("uncaughtException",function(n,t,i,r){return console.log("Uncaught exception in "+i.method+" "+i.path+":"),console.log(r),t.send("server error.")});return u.listen(t.get("server:port"),function(){return console.log(""+u.name+" listening at "+u.url)}),require("./lib/printTask")(r),require("./models/print_log")(r),require("./models/print_manage")(r),require("./routes/service.print")(u)})}).call(this);
/*
//# sourceMappingURL=main.min.js.map
*/